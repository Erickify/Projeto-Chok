<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemplo de Feed</title>
    <!-- Link para o arquivo CSS -->
    <link rel="stylesheet" href="./css/styles-feed.css">
</head>

<body onload="user(), listarPosts()">



    <nav id="nav_feed">

        <section id="sect_perfil_nav">

            <div class="div_nav_topo">


                <img src="./imgs/img_perfil-teste.jpg" alt="" id="img_perfil_nav">

                <div class="div_perfil1_nav_topo">
                </div>

                <div class="div_perfil2_nav_topo">
                </div>

            </div>

        </section>

        <div class="div_nav">

            <div class="nome_user" id="nome_user">

                <h1 class="nomeUsuario">Roberto Carlos</h1>
                <p class="userUsuario">@robeertinho</p>

            </div>


            <ul id="lista_nav">
                <a href="./perfil.html">
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="currentcolor" class="icone_lista">
                            <path
                                d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z" />
                        </svg>

                        <h3>PERFIL</h3>

                    </li>
                </a>
                <a href="#">
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="currentcolor" class="icone_lista">
                            <path
                                d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z" />
                        </svg>

                        <h3>HOME</h3>

                    </li>
                </a>
                <a href="#">
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="currentcolor" class="icone_lista">
                            <path
                                d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z" />
                        </svg>
                        <h3>CONFIG</h3>
                    </li>
                </a>
            </ul>

        </div>



    </nav>

    <main id="main_feed">
        <!-- Contêiner onde o feed será inserido -->
        <div id="feed-container">



        </div>

        <div class="div_post">

            <section id="sect_perfil_post">

                <div class="div_post_topo">


                    <img src="./imgs/img_perfil-teste.jpg" alt="" id="img_perfil_post">

                    <div class="div_perfil1_post_topo">
                    </div>

                    <div class="div_perfil2_post_topo">

                        <div class="nome_user" id="nome_user">

                            <h1 class="nomeUsuario">Roberto Carlos</h1>
                            <p class="userUsuario">@robeertinho</p>

                        </div>

                    </div>

                </div>

            </section>

        </div>

        <div class="div_corpo_post">

            <div class="div_post_desc">

                <p id="desc_post">
                    aaaaaaaaaaaaa
                </p>

            </div>

            <div class="div_post_img">
                <img src="./imgs/img_perfil-teste.jpg" alt="" id="img_corpo_post">
            </div>

        </div>

    </main>

    <aside id="aside_feed">

        <p></p>

        <div id="div_criar_chok">

            <button onclick="criar_popup()">

                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                    fill="currentcolor" class="icone_lista">
                    <path
                        d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z" />
                </svg>
                <h1>Postar</h1>

            </button>
        </div>

    </aside>


    <div id="div_popup">

        <div class="div_nav_topo">


            <img src="./imgs/img_perfil-teste.jpg" alt="" id="img_perfil_nav">

            <div class="div_perfil1_nav_topo">
            </div>

            <div class="div_perfil2_nav_topo">

                <h1 class="nomeUsuario">aa</h1>
                <p class="userUsuario"></p>

            </div>



        </div>

        <div class="div_corpo_popup">

            <textarea name="" id="textarea_comentairo" placeholder="Faça seu Choke"></textarea>
            <input type="file" name="" id="input_imagem">

            <div class="div_btns_popup">
                <button>+</button>
                <button onclick="criar_post()">Postar</button>
            </div>

        </div>
    </div>


    <!-- Script JavaScript -->

    <script src="./js/script-feed.js"></script>
</body>

</html>

<script>

    var nomeUsuario = sessionStorage.NOME_USUARIO
    var emailUsuario = sessionStorage.EMAIL_USUARIO
    var userUsuario = sessionStorage.USER_USUARIO
    var idUsuario = sessionStorage.ID_USUARIO

    var dadosPostVar = []

    var post_idPost = []
    var post_descPost = []
    var post_curtidasPost = []
    var post_imgPost = []
    var post_idUsuario = []
    var post_nomeUsuario = []
    var post_userUsuario = []
    var post_emailUser = []

    function atualizarPosts() {



    }

    function user() {

        console.log(`nome: ${nomeUsuario}`)
        console.log(`email: ${emailUsuario}`)
        console.log(`id: ${idUsuario}`)
        console.log(`user: ${userUsuario}`)



        document.querySelectorAll(".nomeUsuario").forEach(h1 => h1.innerHTML = nomeUsuario);
        document.querySelectorAll(".userUsuario").forEach(p => p.innerHTML = `@${userUsuario}`);



        userUsuario.innerHTML = `@${userUsuario}`

    }


    function criar_post() {

        descPostVar = textarea_comentairo.value
        img = document.getElementById("input_imagem")
        imgPostVar = img.files[0]

        console.log(imgPostVar)

        fetch("/post/postar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({

                idUsuarioServer: idUsuario,
                descPostServer: descPostVar,
                // imgPostServer: imgPostVar,

            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    console.log("Post realizado com sucesso!")
                    fechar_popup()



                } else {
                    throw "Houve um erro ao tentar realizar o post!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

    }

    function listarPosts() {

        fetch("/post/listarPosts")

            .then(response => response.json())

            .then(dadosPost => {

                dadosPost.forEach(resposta => {

                    post_idPost.push(resposta.idPost)

                    post_descPost.push(resposta.descPost)

                    post_curtidasPost.push(resposta.curtidasPost)

                    post_imgPost.push(resposta.imgPost)

                    post_idUsuario.push(resposta.idUsuario)

                    post_nomeUsuario.push(resposta.nomeUsuario)

                    post_userUsuario.push(resposta.userUsuario)

                    post_emailUser.push(resposta.emailUser)

                })

                dadosPost.forEach(resposta => {




                })


            }).catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

    }

    function criar_popup() {

        div_popup.style.display = "block"
        nav_feed.classList.add("blur")
        main_feed.classList.add("blur")
        aside_feed.classList.add("blur")



    }

    function fechar_popup() {

        div_popup.style.display = "none"
        nav_feed.classList.remove("blur");
        main_feed.classList.remove("blur")
        aside_feed.classList.remove("blur")


    }



</script>